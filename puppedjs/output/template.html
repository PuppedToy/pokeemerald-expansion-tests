<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PuppedJS</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724; /* deep navy */
      --card:#0b1220;
      --muted:#98a0b3;
      --accent:#ff7a59;
      --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(255,255,255,0.02);
      --glass-3: rgba(255,255,255,0.1);
      --radius:12px;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%; width:100%;}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background: #071022;
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      min-height:100vh;
    }

    /* Modal */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75); /* darker dim for clarity */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 5000;
      overflow: hidden; /* prevents background scroll bleed */
    }

    .modal.hidden {
      display: none;
    }

    /* The visible modal container */
    .modal-content {
      background: #0f1724; /* fully opaque, matches theme */
      border-radius: 16px;
      width: 92%;
      max-width: 900px;
      max-height: 88vh;
      padding: 28px;
      overflow-y: auto;
      border: 1px solid rgba(231, 234, 37, 1);
      box-shadow:
          0 0 0 1px rgba(255,255,255,0.06) inset,
          0 12px 40px rgba(0,0,0,0.6);

      /* Important: create a visible edge instead of glass fade */
      backdrop-filter: none;
    }

    .modal-bg {
      position: absolute;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0); /* solid background for readability */
      z-index: -1;
    }

    /* Improves readability of headings inside modal */
    .modal-content h2,
    .modal-content h3 {
      margin-top: 20px;
      margin-bottom: 10px;
      text-align: left;
    }

    /* Close button stays the same but more visible */
    .modal-close {
      position: absolute;
      top: 12px;
      right: 12px;
      background: rgba(255,255,255,0.15);
      border: none;
      font-size: 18px;
      color: #fff;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.15s ease;
    }

    .modal-close:hover {
      background: rgba(255,255,255,0.25);
    }

    /* Sidebar */
    .sidebar{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius);
      padding:18px;
      min-height:80vh;
      box-shadow:0 8px 30px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }
    .logo{display:flex;align-items:center;gap:12px}
    .logo .badge{
      width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#ffb07f);display:flex;align-items:center;justify-content:center;font-weight:800;color:#081017
    }
    h1{font-size:16px;margin:0}
    .nav{margin-top:18px}
    .nav a{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;color:var(--muted);text-decoration:none;margin-bottom:6px}
    .nav a:hover{background:var(--glass);color:#fff}
    .nav a.active{background:linear-gradient(90deg, rgba(255,122,89,0.12), rgba(255,122,89,0.06));color:#fff}

    /* Header / Search */
    header.top{
      height: 60px;
      width: 100%;
      display: flex;
      justify-content: space-between;
    }
    .search{display:flex;gap:8px;align-items:center}
    .search input{background:var(--glass-2);border:1px solid rgba(255,255,255,0.03);padding:10px 12px;border-radius:10px;color:#e9f2ff;outline:none;min-width:360px}
    .actions{display:flex;gap:10px;align-items:center}
    .chip{background:var(--glass);padding:8px 10px;border-radius:999px;font-weight:600}
    .rewards {
      margin: 10px 0;
    }
    .reward-item {
      color: #F5BA6C;
    }
    .move-list {
      margin: 4px 0;
      padding: 6px;
    }
    .move-item {
      font-size: 10px;
      border-radius: 8px;
      border-color: black;
      color: #071022;
      margin: 4px 0;
      padding: 4px;
      border: 1px solid;
      font-weight: bold;
    }
    .trainer-poke:hover, .wild-poke:hover {
      background: var(--glass-3) !important;
    }

    /* Main content */
    .app{
      width: 100%;
    }
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
      gap:16px;
    }
    .poke-grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
      gap:16px;
    }
    .trainer-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(400px,1fr));
      gap:16px;
    }
    .right {
      min-width: 240px;
    }
    .main {
      background:transparent;
      display: flex;
      display: flex;
      width: 100%;
      margin: 0 40px;
    }
    .content {
      width: 100%;
      margin-right: 40px;
    }
    .main section {
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
      height: 0;
      overflow: hidden;
      width: 0;
    }
    .main section.active {
      opacity: 1;
      visibility: visible;
      height: auto;
      width: 100%;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;padding:12px;border:1px solid rgba(255,255,255,0.03);
      box-shadow:0 6px 20px rgba(2,6,23,0.5);
      display:flex;flex-direction:column;gap:8px;min-height:140px
    }
    .trainer-card {
      /* width: 400px; */
    }
    .card-log-item{font-size:12px;padding:6px;border-radius:8px;margin-bottom:6px;display:block}
    .dashed{
      text-decoration:line-through;
      color:var(--muted);
      margin-right:4px;
    }
    .clicker{cursor:pointer}
    .thumb{height:200px;border-radius:10px;background:#09121b;display:block;overflow:hidden}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .meta{display:flex;justify-content:space-between;align-items:center}
    .title{font-weight:700; font-size: 26px; margin-bottom: 12px; text-align: center;}
    .sub{font-size:12px;color:var(--muted)}
    .type{display:inline-block;padding:4px 8px;border-radius:8px;font-size:12px;color:#081017;font-weight:600;margin-right:6px;margin-bottom:6px}
    .specialCard{background-color: #450B00;}
    .partnerCard{background-color: #004d00;}
    .tags{display:flex;gap:8px;flex-wrap:wrap}
    .tag{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-size:12px;}
    .ability-tag{display: block; width: 100%; margin: 10px 0;}

    /* Right column */
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .panel h3{margin:0 0 10px 0}
    .list-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px}
    .small{font-size:13px;color:var(--muted)}

    .poke-miniature {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 16px;
      font-weight: bold;
    }

    /* footer */
    footer{grid-column:1/4;margin-top:18px;padding:12px;text-align:center;color:var(--muted)}

    /* Responsive */
    @media (max-width:1000px){
      .app{grid-template-columns:1fr;}
      .sidebar{order:2}
      .app > .right{order:3}
      header.top{grid-column:1/2;margin-top:0}
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="top">
      <div class="logo">
        <img height="60" width="60" src="https://lh4.googleusercontent.com/proxy/1ZU_ZpT8noxzxfsKEqWSQWAbxk-3puSoLlV360G1sxdHpbjNSmmxxNSY_dHGm2vX7NwmmPhK4jvnrpc1_PjZGWtYeglgvc5GVgCXXQFvTxZ0Ba_Yxdo8oqURAqARybK07xKxvw">
        <div>
          <h1>PuppedJS</h1>
          <div class="small">Your custom journey dex</div>
        </div>
      </div>
      <div class="search">
        <input type="search" placeholder="Search" />
        <button class="chip">Search</button>
      </div>
      <div class="actions">
        <div class="chip">Sort: Popular</div>
        <div class="chip">Map</div>
      </div>
    </header>

    <main class="main">

      <div class="content">
        <section id="pokemon">
          <h2>Pokemon</h2>
          <div class="grid" id="pokemon-cards"></div>
        </section>
  
        <section id="moves">
          <h2>Moves</h2>
          <div class="grid" id="moves-cards"></div>
        </section>
  
        <section id="trainers">
          <h2>Trainers</h2>
          <div class="trainer-grid" id="trainers-cards"></div>
        </section>
  
        <section id="wildpokes">
          <h2>Wild Pokemon</h2>
          <div class="grid" id="wildpokes-cards"></div>
        </section>
  
        <section id="abilities">
          <h2>Abilities</h2>
          <div class="grid" id="abilities-cards"></div>
        </section>
      </div>

      <aside class="right">
        <nav class="nav" id="nav">
          <a class="clicker" data-target="pokemon">Pokedex</a>
          <a class="clicker" data-target="moves">Moves</a>
          <a class="clicker" data-target="wildpokes">Locations</a>
          <a class="clicker" data-target="trainers">Trainers</a>
          <a class="clicker" data-target="abilities">Abilities</a>
        </nav>
      </aside>

    </main>
    
    <footer>
      Made with ‚ù§Ô∏è ‚Äî use this to aid your custom journey
    </footer>
  </div>

  <div id="pokemon-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-bg"></div>
      <button class="modal-close">‚úñ</button>
      <div id="pokemon-modal-body"></div>
    </div>
  </div>
  
  <script>
    // --- Tab-style navigation ---
    const navLinks = document.querySelectorAll('.nav a');
    const sections = document.querySelectorAll('main section');

    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        const targetId = link.dataset.target;

        // update active nav
        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');

        // show/hide sections
        sections.forEach(sec => {
          sec.classList.remove('active');
          if (sec.id === targetId) sec.classList.add('active');
        });
      });
    });
  </script>
  <!-- common constants -->
  <script>
    const typeColors = {
        "NORMAL":   "#A8A77A",
        "FIRE":     "#EE8130",
        "WATER":    "#6390F0",
        "ELECTRIC": "#F7D02C",
        "GRASS":    "#7AC74C",
        "ICE":      "#96D9D6",
        "FIGHTING": "#C22E28",
        "POISON":   "#A33EA1",
        "GROUND":   "#E2BF65",
        "FLYING":   "#A98FF3",
        "PSYCHIC":  "#F95587",
        "BUG":      "#A6B91A",
        "ROCK":     "#B6A136",
        "GHOST":    "#735797",
        "DRAGON":   "#6F35FC",
        "DARK":     "#705746",
        "STEEL":    "#B7B7CE",
        "FAIRY":    "#D685AD"
    };
    const tierNames = {
      "GOD": "AG",
      "LEGEND": "Uber",
      "PREMIUM": "OU",
      "STRONG": "UU",
      "AVERAGE": "RU",
      "WEAK": "NU",
      "BAD": "PU",
    };
    const tierColorBgs = {
        "GOD":   "#000000",
        "LEGEND":     "#8F0000",
        "PREMIUM":   "#FF8C00",
        "STRONG":     "#FFEE00",
        "AVERAGE":      "#52E3FF",
        "WEAK":     "#D1FFFC",
        "BAD":     "#D4D4D4",
    };
    const tierColorFonts = {
        "GOD":   "#FFFFFF",
        "LEGEND":     "#FFFFFF",
        "PREMIUM":   "#000000",
        "STRONG":      "#000000",
        "AVERAGE":     "#000000",
        "WEAK":     "#000000",
        "BAD":     "#000000",
    };
    const natures = {
      "Hardy": "Hardy (-)",
      "Lonely": "Lonely (+Atk / -Def)",
      "Brave": "Brave (+Atk / -Spe)",
      "Adamant": "Adamant (+Atk / -Spa)",
      "Naughty": "Naughty (+Atk / -Spd)",
      "Bold": "Bold (+Def / -Atk)",
      "Docile": "Docile (-)",
      "Relaxed": "Relaxed (+Def / -Spe)",
      "Impish": "Impish (+Def / -Spa)",
      "Lax": "Lax (+Def / -Spd)",
      "Timid": "Timid (+Spe / -Atk)",
      "Hasty": "Hasty (+Spe / -Def)",
      "Serious": "Serious (-)",
      "Jolly": "Jolly (+Spe / -Spa)",
      "Naive": "Naive (+Spe / -Spd)",
      "Modest": "Modest (+Spa / -Atk)",
      "Mild": "Mild (+Spa / -Def)",
      "Quiet": "Quiet (+Spa / -Spe)",
      "Bashful": "Bashful (-)",
      "Rash": "Rash (+Spa / -Spd)",
      "Calm": "Calm (+Spd / -Atk)",
      "Gentle": "Gentle (+Spd / -Def)",
      "Sassy": "Sassy (+Spd / -Spe)",
      "Careful": "Careful (+Spd / -Spa)",
      "Quirky": "Quirky (-)"
    };

    function getLogIcon(logEntry) {
      if (!logEntry) return '';
      if (logEntry.type === 'BUFF') {
        return ' ‚≠êÔ∏è';
      } else if (logEntry.type === 'NERF') {
        return ' üîª';
      } else {
        return ' üîß';
      }
    }

    function getLogColor(logEntry) {
      if (!logEntry) return null;
      if (logEntry.type === 'BUFF') {
        return '#CFFFD3';
      } else if (logEntry.type === 'NERF') {
        return '#D49494';
      } else {
        return null;
      }
    }

    function getFullPokeLogIcon(poke) {
      let fullLogIcon = '';
      const allLogIsBuffs = (poke.log || []).every(entry => entry.type === 'BUFF');
      const allLogIsNerfs = (poke.log || []).every(entry => entry.type === 'NERF');
      if (poke.log && poke.log.length > 0) {
        if (allLogIsBuffs) {
          fullLogIcon = ' ‚≠êÔ∏è';
        } else if (allLogIsNerfs) {
          fullLogIcon = ' üîª';
        } else {
          fullLogIcon = ' üîß';
        }
      }
      return fullLogIcon;
    }

    function nameify(name) {
      return name.replace(/_/g, ' ').toLowerCase().replace(/\b\w/g, c => c.toUpperCase());
    }

    function moveName(moveId) {
      return nameify(moveId.replace('MOVE_', ''));
    }

    function getPokeImg(pokeId) {
      return `https://forwardfeed.github.io/ER-nextdex/static/sprites/${pokeId.replace('SPECIES_', '')}.png`
        .replace('ALOLA', 'ALOLAN')
        .replace('GALAR', 'GALARIAN')
        .replace('HISUI', 'HISUIAN')
        .replace('PALDEA', 'PALDEAN')
        .replace(/TAUROS_PALDEAN_(\w+)/, 'TAUROS_PALDEAN_$1_BREED')
        .replace('DUDUNSPARCE_TWO_SEGMENT', 'DUDUNSPARCE_THREE_SEGMENT')
        .replace('CASTFORM_NORMAL', 'CASTFORM')
        .replace('_WEST', '')
        .replace('_EAST', '_EAST_SEA')
        .replace('GIRATINA_ALTERED', 'GIRATINA')
        .replace('SHAYMIN_LAND', 'SHAYMIN')
        .replace('_RED_STRIPED', '')
        .replace('_WHITE_STRIPED', '_WHITESTRIPED')
        .replace('BASCULEGION_M', 'BASCULEGION')
        .replace('_STANDARD', '')
        .replace('_ZEN', '_ZEN_MODE')
        .replace('_GALARIAN_ZEN_MODE', '_ZEN_MODE_GALARIAN')
        .replace('_SPRING', '')
        .replace('_INCARNATE', '')
        .replace('_ORDINARY', '')
        .replace('_ARIA', '')
        .replace('MEOWSTIC_M', 'MEOWSTIC')
        .replace('MEOWSTIC_F', 'MEOWSTIC_FEMALE')
        .replace('_SHIELD', '')
        .replace('_AVERAGE', '')
        .replace('_NEUTRAL', '')
        .replace('/ZYGARDE_50.', '/ZYGARDE.')
        .replace('_AURA_BREAK', '')
        .replace('_CONFINED', '')
        .replace('_BAILE', '')
        .replace('_MIDDAY', '')
        .replace('_SOLO', '')
        .replace('_DISGUISED', '')
        .replace('_ORIGINAL', '_ORIGINAL_COLOR')
        .replace('_AMPED', '')
        .replace('_PHONY', '')
        .replace('EISCUE_ICE', 'EISCUE')
        .replace('EISCUE_NOICE', 'EISCUE_NOICE_FACE')
        .replace('INDEEDEE_M', 'INDEEDEE')
        .replace('INDEEDEE_F', 'INDEEDEE_FEMALE')
        .replace('_FULL_BELLY', '')
        .replace('_HERO', '')
        .replace('ZACIAN_CROWNED', 'ZACIAN_CROWNED_SWORD')
        .replace('ZAMAZENTA_CROWNED', 'ZAMAZENTA_CROWNED_SHIELD')
        .replace('_SINGLE_STRIKE', '')
        .replace('_RAPID_STRIKE', '_RAPID_STRIKE_STYLE')
        .replace('CALYREX_ICE', 'CALYREX_ICE_RIDER')
        .replace('CALYREX_SHADOW', 'CALYREX_SHADOW_RIDER')
        .replace('OINKOLOGNE_M', 'OINKOLOGNE')
        .replace('OINKOLOGNE_F', 'OINKOLOGNE')
        .replace('MAUSHOLD_THREE', 'MAUSHOLD_FOUR')
        .replace(/(SQUAWKABILLY_\w+)/, '$1_PLUMAGE')
        .replace('_ZERO', '')
        .replace('GIMMIGHOUL_CHEST', 'GIMMIGHOUL')
        .replace(/POLTCHAGEIST_\w+/, 'POLTCHAGEIST')
        .replace(/SINISTCHA_\w+/, 'SINISTCHA')
        .replace('TERAPAGOS_NORMAL', 'TERAPAGOS')
        .replace('TERAPAGOS_TERASTAL', 'TERAPAGOS')
        .replace('DEOXYS_NORMAL', 'DEOXYS')
        .replace('CHERRIM_OVERCAST', 'CHERRIM');
    }

    function getFormattedPokeTypes(types) {
      return types.map(type => `<span class="type" style="background-color:${typeColors[type]}">${type}</span>`).join(' ');
    }

    function generatePokeCardContent(poke) {
      const pokeImg = getPokeImg(poke.id);
      const hpLogEntry = (poke.log || []).find(entry => entry.target === 'baseHP');
      const atkLogEntry = (poke.log || []).find(entry => entry.target === 'baseAttack');
      const defLogEntry = (poke.log || []).find(entry => entry.target === 'baseDefense');
      const spaLogEntry = (poke.log || []).find(entry => entry.target === 'baseSpAttack');
      const spdLogEntry = (poke.log || []).find(entry => entry.target === 'baseSpDefense');
      const speLogEntry = (poke.log || []).find(entry => entry.target === 'baseSpeed');
      const BSTChangeValue = (hpLogEntry?.value || 0)
        + (atkLogEntry?.value || 0)
        + (defLogEntry?.value || 0)
        + (spaLogEntry?.value || 0)
        + (spdLogEntry?.value || 0)
        + (speLogEntry?.value || 0);
      const bstIcon = BSTChangeValue > 0 ? ' ‚≠êÔ∏è' : BSTChangeValue < 0 ? ' üîª' : '';
      const typeEntry = (poke.log || []).find(entry => entry.target === 'type');
      const typeIcon = getLogIcon(typeEntry);
      const abilityEntry = (poke.log || []).find(entry => entry.target === 'ability');
      const abilityIcon = getLogIcon(abilityEntry);
      let fullLogIcon = getFullPokeLogIcon(poke);
      const adjustedHP = hpLogEntry ? `<span style="color:${getLogColor(hpLogEntry)}"><span class="dashed">${hpLogEntry.oldValue}</span> <strong>${poke.baseHP}</strong></span>` : `${poke.baseHP}`;
      const adjustedAtk = atkLogEntry ? `<span style="color:${getLogColor(atkLogEntry)}"><span class="dashed">${atkLogEntry.oldValue}</span> <strong>${poke.baseAttack}</strong></span>` : `${poke.baseAttack}`;
      const adjustedDef = defLogEntry ? `<span style="color:${getLogColor(defLogEntry)}"><span class="dashed">${defLogEntry.oldValue}</span> <strong>${poke.baseDefense}</strong></span>` : `${poke.baseDefense}`;
      const adjustedSpa = spaLogEntry ? `<span style="color:${getLogColor(spaLogEntry)}"><span class="dashed">${spaLogEntry.oldValue}</span> <strong>${poke.baseSpAttack}</strong></span>` : `${poke.baseSpAttack}`;
      const adjustedSpd = spdLogEntry ? `<span style="color:${getLogColor(spdLogEntry)}"><span class="dashed">${spdLogEntry.oldValue}</span> <strong>${poke.baseSpDefense}</strong></span>` : `${poke.baseSpDefense}`;
      const adjustedSpe = speLogEntry ? `<span style="color:${getLogColor(speLogEntry)}"><span class="dashed">${speLogEntry.oldValue}</span> <strong>${poke.baseSpeed}</strong></span>` : `${poke.baseSpeed}`;
      const adjustedBST = BSTChangeValue !== 0 ? `<span style="color:${BSTChangeValue > 0 ? '#CFFFD3' : '#D49494'}"><span class="dashed">${poke.baseBST - BSTChangeValue}</span> <strong>${poke.baseBST}</strong></span>` : `${poke.baseBST}`;
      const abilitiesLogEntries = (poke.log || []).filter(entry => entry.target === 'ability');
      let abilities = poke.parsedAbilities.map(ability => {
        const abilityLogEntry = abilitiesLogEntries.find(entry => entry.value === ability);
        let abilityContent = nameify(ability);
        if (abilityLogEntry && abilityLogEntry.type === 'ADJUSTMENT') {
          abilityContent = `üîß <span class="dashed">${nameify(abilityLogEntry.oldValue)}</span> <strong>${abilityContent}</strong>`;
        }
        else if (abilityLogEntry) {
          abilityContent = `‚≠êÔ∏è ${abilityContent}`;
        }
        return `<span class="tag ability-tag">${abilityContent}</span>`;
      }).join(' ');
      return `
        <div class="meta">
            <div>
                <div class="title">${poke.name}${fullLogIcon}</div>
                <div class=thumb><img src="${pokeImg}" alt="${poke.name}" /></div>
                <div style="margin-top: 10px; text-align: center; width: 100%;">${getFormattedPokeTypes(poke.parsedTypes)}${typeIcon}</div>
                <div style="margin-top: 10px; text-align: center; width: 100%;">${abilities}</div>
                <div>
                    <div style="text-align: center; font-weight: 700; margin-top: 6px; color: #FFDDC9">BST: ${adjustedBST}${bstIcon}</div>
                    <div style="text-align: center"><div style="text-align: center; font-weight: 700; margin-top: 6px; background-color: ${tierColorBgs[poke.rating.tier]}; color: ${tierColorFonts[poke.rating.tier]}; display: inline-block; padding: 4px 12px; border-radius: 999px;">${tierNames[poke.rating.tier]} (${poke.rating.role})</div></div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(2, auto); gap: 6px; margin-top: 10px;">
                        <div style="font-weight: 700; color: #BDF8FF">HP</div>
                        <div style="font-weight: 700; color: #BDF8FF">ATK</div>
                        <div style="font-weight: 700; color: #BDF8FF">DEF</div>
                        <div>${adjustedHP}</div>
                        <div>${adjustedAtk}</div>
                        <div>${adjustedDef}</div>
                        <div style="font-weight: 700; color: #BDF8FF">SPA</div>
                        <div style="font-weight: 700; color: #BDF8FF">SPD</div>
                        <div style="font-weight: 700; color: #BDF8FF">SPE</div>
                        <div>${adjustedSpa}</div>
                        <div>${adjustedSpd}</div>
                        <div>${adjustedSpe}</div>
                    </div>
                </div>
            </div>
        </div>
      `;
      return card;
    }
  </script>
  <script src="pokes.js"></script>
  <script src="moves.js"></script>
  <script src="trainers.js"></script>
  <script src="wildpokes.js"></script>
  <script src="abilities.js"></script>
  <!-- script to handle pokedex -->
  <script>
    const pokemonGrid = document.getElementById('pokemon-cards');
    pokes.forEach(poke => {
      const card = document.createElement('div');
      const cardContent = generatePokeCardContent(poke);
      card.className = 'card clicker';
      card.innerHTML = cardContent;
      card.addEventListener('click', () => showPokemonModal(poke));
      pokemonGrid.appendChild(card);
    });
  </script>
  <!-- script to handle moves -->
  <script>
    const movesGrid = document.getElementById('moves-cards');

    // Transform movesData ‚Üí array sorted alphabetically
    const sortedMoves = Object.values(movesData).sort((a, b) =>
      a.name.localeCompare(b.name)
    );

    function formatCategory(cat) {
      switch (cat) {
        case 'DAMAGE_CATEGORY_PHYSICAL': return 'Physical';
        case 'DAMAGE_CATEGORY_SPECIAL':  return 'Special';
        case 'DAMAGE_CATEGORY_STATUS':   return 'Status';
        default: return cat;
      }
    }

    function categoryColor(cat) {
      switch (cat) {
        case 'DAMAGE_CATEGORY_PHYSICAL': return '#d65f5f'; // red-ish
        case 'DAMAGE_CATEGORY_SPECIAL':  return '#5fa0ff'; // blue-ish
        case 'DAMAGE_CATEGORY_STATUS':   return '#b37cff'; // purple-ish
        default: return '#888';
      }
    }

    function cleanTarget(str) {
      return str
        .replace('MOVE_TARGET_', '')
        .replace(/_/g, ' ')
        .toLowerCase()
        .replace(/\b\w/g, c => c.toUpperCase());
    }

    sortedMoves.forEach(move => {
      const card = document.createElement('div');
      card.className = 'card';

      const catName = formatCategory(move.category);
      const catColor = categoryColor(move.category);

      card.innerHTML = `<div class="meta">
        <div>
          <div class="title">${move.name}</div>

          <div style="text-align:center; margin-bottom:10px;">
            <span class="type" style="background-color:${typeColors[move.type]};">${move.type}</span>
            <span class="type" style="background-color:${catColor};">${catName}</span>
          </div>

          <div class="small" style="text-align:center; margin-bottom:6px;">
            Power: <b>${move.power ?? '-'}</b> &nbsp;‚Ä¢&nbsp;
            Accuracy: <b>${move.accuracy ?? '-'}</b>% &nbsp;‚Ä¢&nbsp;
            PP: <b>${move.pp}</b>
          </div>

          <div class="small" style="text-align:center; margin-bottom:6px;">
            Priority: <b>${move.priority}</b>
          </div>

          <div class="small" style="text-align:center;">
            Target: ${cleanTarget(move.target)}
          </div>
        </div></div>`;

      movesGrid.appendChild(card);
    });
  </script>
  <!-- script to handle trainers -->
  <script>
    const trainerSprites = {
      'Unknown': '/b/bf/Spr_FRLG_Oak_Beta.png',
      'Youngster': '/c/c5/Spr_RS_Youngster.png',
      'Bird Keeper': '/4/4f/Spr_RS_Bird_Keeper.png',
      'May': '/a/a4/Spr_E_May.png',
      'Brendan': '/e/e6/Spr_E_Brendan.png',
      'Bug Catcher': '/7/7f/Spr_RS_Bug_Catcher.png',
      'Lass': '/1/16/Spr_RS_Lass.png',
      'Fisherman': '/9/9a/Spr_RS_Fisherman.png',
      'Lady': '/2/2d/Spr_RS_Lady.png',
      'Aqua Grunt M': '/7/74/Spr_RS_Team_Aqua_Grunt_M.png',
      'Rich Boy': '/d/d7/Spr_RS_Rich_Boy.png',
      'Twins': '/3/34/Spr_RS_Twins.png',
      'Expert M': '/d/d0/Spr_RS_Expert_M.png',
      'Psychic F': '/6/6b/Spr_RS_Psychic_F.png',
      'Leader Roxanne': '/e/ef/Spr_RS_Roxanne.png',
      'Hiker': '/b/b7/Spr_RS_Hiker.png',
      'School Kid M': '/5/54/Spr_RS_School_Kid_M.png',
      'School Kid F': '/4/4f/Spr_RS_School_Kid_F.png',
      'Ruin Maniac': '/9/9a/Spr_RS_Ruin_Maniac.png',
      'Leader Brawly': '/9/92/Spr_RS_Brawly.png',
      'Steven': '/a/ad/Spr_RS_Steven.png',
      'Tuber F': '/d/d9/Spr_RS_Tuber_F.png',
      'Sailor': '/f/f1/Spr_RS_Sailor.png',
      'Tuber M': '/e/ed/Spr_RS_Tuber_M.png',
      'Pokefan F': '/6/63/Spr_RS_Pok√©fan_F.png',
      'Pokefan M': '/a/a3/Spr_RS_Pok√©fan_M.png',
      'Psychic M': '/b/b7/Spr_RS_Psychic_M.png',
      'Aroma Lady': '/2/22/Spr_RS_Aroma_Lady.png',
      'Guitarist': '/1/14/Spr_RS_Guitarist.png',
      'Collector': '/2/28/Spr_RS_Collector.png',
      'Wally': '/8/87/Spr_RS_Wally.png',
      'Pokemon Breeder M': '/5/55/Spr_RS_Pok√©mon_Breeder_M.png',
      'Running Triathlete M': '/8/8d/Spr_RS_Triathlete_Runner_M.png',
      'Pokemon Breeder F': '/a/a8/Spr_RS_Pok√©mon_Breeder_F.png',
      'Bug Maniac': '/4/4f/Spr_RS_Bug_Maniac.png',
      'Sr And Jr': '/7/70/Spr_RS_Sr_and_Jr.png',
      'Running Triathlete F': '/2/21/Spr_RS_Triathlete_Runner_F.png',
      'Battle Girl': '/5/54/Spr_RS_Battle_Girl.png',
      'Leader Wattson': '/b/b2/Spr_RS_Wattson.png',
      'Kindler': '/0/07/Spr_RS_Kindler.png',
      'Camper': '/e/e1/Spr_RS_Camper.png',
      'Picnicker': '/7/71/Spr_RS_Picnicker.png',
      'Cooltrainer F': '/7/78/Spr_RS_Cooltrainer_F.png',
      'Magma Admin': '/5/51/Spr_RS_Tabitha.png',
      'Magma Leader Maxie': '/e/e3/Spr_RS_Maxie.png',
      'Cooltrainer M': '/f/f8/Spr_RS_Cooltrainer_M.png',
      'Ninja Boy': '/b/bc/Spr_RS_Ninja_Boy.png',
      'Pokemaniac': '/6/61/Spr_RS_Pok√©Maniac.png',
      'Parasol Lady': '/e/ea/Spr_RS_Parasol_Lady.png',
      'Black Belt': '/f/f8/Spr_RS_Black_Belt.png',
      'Leader Flannery': '/b/be/Spr_RS_Flannery.png',
      'Leader Norman': '/7/75/Spr_RS_Norman.png',
      'Swimmer F': '/7/77/Spr_RS_Swimmer_F.png',
      'Cycling Triathlete F': '/0/0d/Spr_RS_Triathlete_Biker_F.png',
      'Aqua Admin F': '/e/e2/Spr_RS_Shelly.png',
      'Leader Winona': '/0/0e/Spr_RS_Winona.png',
      'Hex Maniac': '/3/3d/Spr_RS_Hex_Maniac.png',
      'Beauty': '/c/cb/Spr_RS_Beauty.png',
      'Gentleman': '/f/f8/Spr_RS_Gentleman.png',
      'Aqua Admin M': '/d/d0/Spr_RS_Matt.png',
      'Swimmer M': '/6/6e/Spr_RS_Swimmer_M.png',
      'Swimming Triathlete F': '/6/60/Spr_RS_Triathlete_Swimmer_F.png',
      'Leader Tate And Liza': '/3/38/Spr_RS_Tate_and_Liza.png',
      'Magma Grunt M': '/a/a0/Spr_RS_Team_Magma_Grunt_M.png',
      'Magma Grunt F': '/0/03/Spr_RS_Team_Magma_Grunt_F.png',
      'Swimming Triathlete M': '/8/8a/Spr_RS_Triathlete_Swimmer_M.png',
      'Aqua Leader Archie': '/f/fe/Spr_RS_Archie.png',
      'Leader Juan': '/1/16/Spr_E_Juan.png',
      'Elite Four Sidney': '/8/86/Spr_RS_Sidney.png',
      'Elite Four Phoebe': '/e/e6/Spr_RS_Phoebe.png',
      'Elite Four Glacia': '/7/71/Spr_RS_Glacia.png',
      'Elite Four Drake': '/0/04/Spr_RS_Drake.png',
    };

    function getTrainerImg(trainerClass) {
      return `https://archives.bulbagarden.net/media/upload${trainerSprites[trainerClass] || trainerSprites.Unknown}`;
    }

    function findPoke(pokeId) {
      return pokes.find(p => p.id === pokeId);
    }

    const trainersGrid = document.getElementById('trainers-cards');

    Object.entries(trainersData).forEach(([trainerId, trainer]) => {
      const card = document.createElement('div');
      card.className = 'card trainer-card';
      if (trainer.isBoss) {
        card.classList.add('specialCard');
      }
      if (trainer.isPartner) {
        card.classList.add('partnerCard');
      }

      const trainerName = nameify(trainerId.replace('TRAINER_', '').replace(/_\d/g, ''));

      // Build each Pok√©mon slot
      const teamHTML = trainer.team.map(member => {
        const pokeId = member.pokemon || '';
        const pokeName = pokeId.replace('SPECIES_', '').replace(/_/g, ' ') + getFullPokeLogIcon(findPoke(pokeId));
        const imgSrc = getPokeImg(pokeId);
        const item = member.item ? `<div class="small" style="color:#FFD580">üéí ${member.item}</div>` : '';
        const ability = member.ability ? `<div class="small" style="color:#D1F2FF; margin-top: 4px">${nameify(member.ability)}</div>` : '';
        const nature = member.nature ? `<div class="small" style="color:#A5D9B8; margin-top: 4px">${natures[member.nature]}</div>` : '';
        const moves =
          member.moves && member.moves.length > 0
            ? `<div class="move-list">
                ${member.moves.map(m => {
                  const move = movesData[m];
                  const typeColor = move ? typeColors[move.type] : '#888';
                  return `<div class="move-item" style="background-color:${typeColor}">${nameify(m.replace('MOVE_', ''))}</div>`;
                }).join('')}
              </div>`
            : '';

        return `
          <div class="clicker trainer-poke poke-${pokeId}" style="text-align:center; background:rgba(255,255,255,0.02); padding:6px; border-radius:10px;">
            <img src="${imgSrc}" style="width:64px;height:64px;object-fit:contain" alt="${pokeName}">
            <div style="font-weight:700;margin-top:4px">${pokeName}</div>
            ${item}
            ${ability}
            ${nature}
            ${moves}
          </div>
        `;
      }).join('');

      let rewards = '';
      if (trainer.reward && trainer.reward.length > 0) {
        rewards = `<div class="rewards">
          ${trainer.reward.map(r => '<div class="reward-item">üéÅ ' + r + '</div>').join('')}
        </div>
        `;
      }

      // Final card markup
      card.innerHTML = `
        <div style="text-align:center;">
          <div class="title">${trainerName}</div>
          <img width="60" height="60" src="${getTrainerImg(trainer.class)}">
          <div class="small" style="text-align:center; color:#FFB28A;">Lv. ${trainer.level}</div>
          ${rewards}
          <div class="grid" style="grid-template-columns:repeat(auto-fill, minmax(150px,1fr)); gap:8px;">
            ${teamHTML}
          </div>
        </div>
      `;

      trainersGrid.appendChild(card);
      // Find every trainer-poke card to add click event
      const trainerPokeCards = card.querySelectorAll('.trainer-poke');
      trainerPokeCards.forEach(tpCard => {
        const pokeId = tpCard.className.match(/poke-(SPECIES_[A-Z0-9_]+)/)[1];
        const poke = findPoke(pokeId);
        if (poke) {
          tpCard.addEventListener('click', () => showPokemonModal(poke));
        }
      });
    });
  </script>
  <!-- script to handle routes -->
  <script>
    function getRouteTypeName(type) {
      switch (type) {
        case 'land': return 'Grass';
        case 'old': return 'Fishing (Old Rod)';
        case 'good': return 'Fishing (Good Rod)';
        case 'surf': return 'Surf';
        case 'underwater': return 'Underwater';
        case 'super': return 'Fishing (Super Rod)';
        case 'special':
        case 'special1':
        case 'special2':
        case 'special3':
        case 'special4':
        case 'special5':
        case 'special6':
        case 'special7':
        case 'special8':
        case 'special9':
          return 'Special';
        default: return type;
      }
    }

    const routesGrid = document.getElementById('wildpokes-cards');

    wildPokes.forEach(route => {
      const card = document.createElement('div');
      card.className = 'card';

      // Clean route name
      const routeName = nameify(route.id.replace('MAP_', ''));

      const encounterTypes = ['land', 'old', 'good', 'surf', 'underwater', 'super', 'special', 'special1', 'special2', 'special3', 'special4', 'special5', 'special6', 'special7', 'special8', 'special9'];

      const encountersHTML = encounterTypes
        .filter(type => route[type])
        .map(type => {
          const pokeId = route[type];
          const pokeName = nameify(pokeId.replace('SPECIES_', ''));
          const img = getPokeImg(pokeId);
          let adjustmentIcon = '';
          const poke = findPoke(pokeId);
          if (poke && poke.log && poke.log.length > 0) {
            (poke.log || []).forEach(entry => {
              if (adjustmentIcon === '' && (entry.type === 'BUFF' || entry.type === 'NERF')) {
                adjustmentIcon = getLogIcon(entry);
              }
              else if ((adjustmentIcon === ' ‚≠êÔ∏è' && entry.type !== 'BUFF') || (adjustmentIcon === ' üîª' && entry.type !== 'NERF')) {
                adjustmentIcon = ' üîß';
              }
            });
          }
          return `
            <div class="clicker wild-poke poke-${pokeId}" style="text-align:center; background:rgba(255,255,255,0.02); padding:6px; border-radius:10px;">
              <div style="font-size:12px; color:#FFB28A; margin-bottom:4px;">${getRouteTypeName(type)}</div>
              <img src="${img}" style="width:64px;height:64px;object-fit:contain" alt="${pokeName}">
              <div style="font-weight:700;margin-top:4px">${pokeName}${adjustmentIcon}</div>
            </div>
          `;
        })
        .join('');

      card.innerHTML = `
        <div class="meta">
          <div class="title">${routeName}</div>
        </div>
        <div class="grid" style="grid-template-columns:repeat(auto-fill, minmax(100px,1fr)); gap:8px;">
          ${encountersHTML}
        </div>
      `;

      routesGrid.appendChild(card);
      // Find every wild-poke card to add click event
      const wildPokeCards = card.querySelectorAll('.wild-poke');
      wildPokeCards.forEach(wpCard => {
        const pokeId = wpCard.className.match(/poke-(SPECIES_[A-Z0-9_]+)/)[1];
        const poke = findPoke(pokeId);
        if (poke) {
          wpCard.addEventListener('click', () => showPokemonModal(poke));
        }
      });
    });
  </script>
  <!-- script to handle abilities -->
  <script>
    const abilitiesGrid = document.getElementById('abilities-cards');

    // Convert object ‚Üí array and sort alphabetically
    const sortedAbilities = Object.entries(abilitiesData)
      .map(([id, ability]) => ({ id, ...ability }))
      .sort((a, b) => a.name.localeCompare(b.name));

    sortedAbilities.forEach(ability => {
      const card = document.createElement('div');
      card.className = 'card';

      // rating color based on 0‚Äì10
      const ratingColor = ability.rating >= 8 ? '#ff4444' :
                          ability.rating >= 6 ? '#ffaa33' :
                          ability.rating >= 4 ? '#ffee55' :
                          ability.rating >= 2 ? '#88ff88' :
                          '#cccccc';

      const breakableText = ability.breakable
        ? `<div class="small" style="color:#ff7979;">Breakable</div>`
        : `<div class="small" style="color:#8cffd4;">Unbreakable</div>`;

      card.innerHTML = `
        <div class="meta">
          <div>
            <div class="title">${ability.name}</div>

            <div class="small" style="margin-bottom:10px; color:#FFD19A;">
              Ability ID: <span style="opacity:0.7">${ability.id}</span>
            </div>

            <div class="small" style="margin-bottom:12px;">
              ${ability.description}
            </div>

            <div class="small" style="margin-bottom:6px;">
              ${breakableText}
            </div>

            <div style="text-align:center; margin-top:10px;">
              <div style="
                display:inline-block;
                padding:4px 12px;
                border-radius:999px;
                font-weight:700;
                background:${ratingColor};
                color:#000;
              ">
                Rating: ${ability.rating}
              </div>
            </div>
          </div>
        </div>
      `;

      abilitiesGrid.appendChild(card);
    });
  </script>
  <!-- script to handle modal -->
  <script>
    const modal = document.getElementById('pokemon-modal');
    const modalBody = document.getElementById('pokemon-modal-body');
    const modalClose = document.querySelector('.modal-close');
    const modalBg = document.querySelector('.modal-bg');
    modalClose.addEventListener('click', () => modal.classList.add('hidden'));
    modalBg.addEventListener('click', () => modal.classList.add('hidden'));

    function showPokemonModal(poke) {
      modal.classList.remove('hidden');
      modalBody.innerHTML = buildPokemonDetailHTML(poke);
    }

    function buildLearnsetList(poke) {
      return poke.learnset.map(l => {
        const m = movesData[l.move];
        let balanceIcon = '';
        const logEntry = (poke.log || []).find(entry => entry.target === 'learnsetMove' && entry.value === l.move);
        if (logEntry && logEntry.oldValue === null) {
          balanceIcon = '‚≠êÔ∏è '; // Added move
        } else if (logEntry && logEntry.oldValue !== null) {
          balanceIcon = 'üîß ';
        }
        let move = moveName(l.move);
        if (logEntry && logEntry.oldValue) {
          move = `<span style="color:${getLogColor(logEntry)}"><span class="dashed">${moveName(logEntry.oldValue)}</span> <strong>${move}</strong></span>`;
        }
        return `
          <div class="list-item">
            ${balanceIcon}<span style="min-width:60px;color:#8cf;">Lv ${l.level}</span>
            <span class="type" style="background:${typeColors[m.type]};">${m.type}</span>
            <b>${move}</b>
            <span class="small">Pwr: ${m.power ?? '-'}</span>
            <span class="small">Acc: ${m.accuracy ?? '-'}</span>
            <span class="small">PP: ${m.pp}</span>
          </div>`;
      }).join('');
    }

    function buildTeachablesList(poke) {
      return poke.teachables.map(moveId => {
        const m = movesData[moveId];
        return `
          <div class="list-item">
            <span class="type" style="background:${typeColors[m.type]};">${m.type}</span>
            <b>${moveName(moveId)}</b>
            <span class="small">Pwr: ${m.power ?? '-'}</span>
            <span class="small">Acc: ${m.accuracy ?? '-'}</span>
            <span class="small">PP: ${m.pp}</span>
          </div>`;
      }).join('');
    }

    function buildEvoChain(poke) {
      if (!poke.evoTree) return '';
      function format(id) {
        const pokeImg = getPokeImg(id);
        return `<span class="poke-miniature"><img src="${pokeImg}" height="32" width="32" alt="${poke.name}" />${id.replace('SPECIES_', '').replace(/_/g, ' ').toLowerCase().replace(/\b\w/g, c => c.toUpperCase())}</span>`;
      }
      function buildEvoItem(evo) {
        const methodMap = {
          'LEVEL': `Level ${evo.param}`,
          'ITEM': `${evo.param.replace('ITEM_', '').replace(/_/g, ' ').toLowerCase().replace(/\b\w/g, c => c.toUpperCase())}`,
          'TRADE': 'Trade',
          'FRIENDSHIP': 'High Friendship',
          'HOLD_ITEM': `Hold ${evo.param.replace('ITEM_', '').replace(/_/g, ' ').toLowerCase().replace(/\b\w/g, c => c.toUpperCase())}`,
          // Add more methods as needed
        };
        let methodText = methodMap[evo.method] || evo.method;
        if (methodText === 'Level 0') methodText = 'Special Evolution';
        return `<div style="margin-bottom: 20px;">
          <div class="tag evo-link" data-id="${evo.pokemon}">${format(evo.pokemon)} ${methodText}</div>
        </div>`;
      }
      function buildTreeItem(item) {
        if (Array.isArray(item))
          return item.map(i => format(i)).join('');
        return format(item);
      }
      const evoHTML = (poke.evolutions || []).map(e => buildEvoItem(e)).join('');
      const evoTreeHTML = poke.evoTree.map(e => buildTreeItem(e)).join(' ‚Üí ');
      return `${evoHTML}
      <div style="display: flex; align-items: center; gap: 6px;">${evoTreeHTML}</div>`;
    }

    function buildLog(poke) {
      if (!poke.log || poke.log.length === 0) return `<div class="small">No changes</div>`;
      return poke.log.map(l => {
        const icon = getLogIcon(l);
        const targetDictionary = {
          baseAttack: 'Attack',
          baseDefense: 'Defense',
          baseSpAttack: 'Special Attack',
          baseSpDefense: 'Special Defense',
          baseSpeed: 'Speed',
          baseHP: 'HP',
          type: 'Type',
          ability: 'Ability',
          learnsetMove: 'Learnset Move',
        }
        const formatValue = (value) => {
          if (l.target === 'type' && value) {
            return `&nbsp;${getFormattedPokeTypes([value])}`;
          }
          else if (l.target === 'learnsetMove' && value) {
            return moveName(value);
          }
        }
        let newValue = formatValue(l.value) || l.value;
        let logContent = `‚ûï ${newValue}`;
        if (l.oldValue) {
          let oldValue = formatValue(l.oldValue) || l.oldValue;
          if (typeof newValue === 'number') {
            newValue += oldValue;
          }
          logContent = `${oldValue} ‚Üí ${newValue}`;
        }
        return `<div class="small card-log-item">
          ${icon} <strong>${targetDictionary[l.target] || l.target}</strong> ‚Äî ${logContent}
        </div>`;
      }
      ).join('');
    }

    function buildPokemonDetailHTML(poke) {
      const card = generatePokeCardContent(poke);

      return `
        <div style="display: flex; justify-content: center; margin-bottom: 20px;">
          <div class="card">
            ${card}
          </div>
        </div>

        <h3>Evolution</h3>
        <div>${buildEvoChain(poke)}</div>

        <h3>Best Evolution</h3>
        <div class="small">Best Evo Tier: <b>${poke.rating.bestEvoTier}</b></div>
        <div class="small">Mega Evo Tier: <b>${poke.rating.megaEvoTier}</b></div>

        <h3>Learnset</h3>
        <div>${buildLearnsetList(poke)}</div>

        <h3>Teachables</h3>
        <div>${buildTeachablesList(poke)}</div>

        <h3>Change Log</h3>
        <div>${buildLog(poke)}</div>
      `;
    }

    // Click links in evo chain
    document.addEventListener('click', e => {
      if (e.target.classList.contains('evo-link')) {
        const id = e.target.dataset.id;
        const p = pokes.find(x => x.id === id);
        if (p) showPokemonModal(p);
      }
    });
  </script>
  <!-- loader -->
  <script>
    window.addEventListener('load', () => {
      // Activate first tab
      const firstNavLink = document.querySelector('.nav a');
      if (firstNavLink) firstNavLink.click();
    });
  </script>
</body>
</html>
